{{#each erros}}
<div class="alert alert-danger">{{texto}}</div>
{{else}}

{{/each}}

<div class="card mb-3 text-center" style="max-width: 19rem;margin:0 auto; margin-top:30px">
    <div class="card-header text-white bg-dark border">
        <h5> Cadastro</h5>
    </div>
    <div class="card-body text-dark">

        <form class="needs-validation" action="" method="post" novalidate>

             <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="radio_tipo" id="opc_medico" value="opc_medico">
                <label class="form-check-label" for="opc_medico">Médico</label>
            </div>


            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="radio_tipo" id="opc_paciente" value="opc_paciente">
                <label class="form-check-label" for="opc_paciente">Paciente</label>
            </div>

            <div class="mt-2">
                <label for="nome">Nome: </label>
                <input type="text" name="nome" id="nome" class="form-control" required>
                <div id="msgNome" class="invalid-feedback"></div>
            </div>
            <div class="mt-2">
                <label for="email">Email: </label>
                <input type="email" id="email" name="email" class="form-control" required>
                <div id="msgEmail" class="invalid-feedback"></div>
            </div>
            <div class="mt-2">
                <label for="cpf">CPF: </label>
                <input type="text" id="cpf" maxlength="14" name="cpf" class="form-control" required>
                <div id="msgCpf" class="invalid-feedback"></div>
            </div>
            <div class="mt-2">
                <label for="senha">Senha: </label>
                <input type="password" id="senha" name="senha" class="form-control" required>
                <div id="msgSenha" class="invalid-feedback"></div>
            </div>
            <div class="mt-2">
                <label for="senha2">Digite a senha novamente: </label>
                <input type="password" id="senha2" name="senha2" class="form-control" required>
                <div id="msgSenha2" class="invalid-feedback"></div>
            </div>





    </div>


    <div class="card-footer bg-dark">
        <button class="btn btn-block bg-laranja text-white" type="submit">Cadastrar</button>

    </div>
    </form>
</div>


<script type="text/javascript">

    (function () {
        'use strict';
        window.addEventListener('load', function () {

            window.msgNome = document.getElementById("msgNome");
            window.msgEmail = document.getElementById("msgEmail");
            window.msgCpf = document.getElementById("msgCpf");
            window.msgSenha = document.getElementById("msgSenha");
            window.msgSenha2 = document.getElementById("msgSenha2")



            window.campoCpf = document.getElementById("cpf")
            campoCpf.addEventListener("input", function () {

                //mascara
                campoCpf.value = campoCpf.value.replace(/(\D)/g, "")
                campoCpf.value = campoCpf.value.replace(/(\d{3})(\d)/, "$1.$2")
                campoCpf.value = campoCpf.value.replace(/(\d{3})(\d)/, "$1.$2")
                campoCpf.value = campoCpf.value.replace(/(\d{3})(\d{1,2})/, "$1-$2")

                window.cpf = campoCpf.value



                window.d1 = cpf.substring(0, 3)
                window.d2 = cpf.substring(4, 7)
                window.d3 = cpf.substring(8, 11)
                window.d = cpf.substring(12, 14)

                const cpfzao = d1 + d2 + d3 + d


                // Elimina CPFs invalidos conhecidos
                if (cpfzao.length != 11 ||
                    cpfzao == "00000000000" ||
                    cpfzao == "11111111111" ||
                    cpfzao == "22222222222" ||
                    cpfzao == "33333333333" ||
                    cpfzao == "44444444444" ||
                    cpfzao == "55555555555" ||
                    cpfzao == "66666666666" ||
                    cpfzao == "77777777777" ||
                    cpfzao == "88888888888" ||
                    cpfzao == "99999999999"
                ) {
                    campoCpf.classList.remove("is-valid")
                    campoCpf.classList.add("is-invalid")
                    msgCpf.innerHTML = "CPF inválido";
                    return false;

                };

                // Valida 1o digito
                var add = 0;
                var i, rev;

                for (i = 0; i < 9; i++)
                    add += parseInt(cpfzao.charAt(i)) * (10 - i);
                rev = 11 - (add % 11);
                if (rev == 10 || rev == 11)
                    rev = 0;
                if (rev != parseInt(cpfzao.charAt(9))) {
                    campoCpf.classList.remove("is-valid")
                    campoCpf.classList.add("is-invalid")
                    msgCpf.innerHTML = "CPF inválido";
                    return false;
                };

                // Valida 2o digito
                add = 0;

                for (i = 0; i < 10; i++)
                    add += parseInt(cpfzao.charAt(i)) * (11 - i);
                rev = 11 - (add % 11);
                if (rev == 10 || rev == 11)
                    rev = 0;
                if (rev != parseInt(cpfzao.charAt(10))) {
                    campoCpf.classList.remove("is-valid")
                    campoCpf.classList.add("is-invalid")
                    msgCpf.innerHTML = "CPF inválido";
                    return false;
                };

                campoCpf.classList.remove("is-invalid");
                campoCpf.classList.add("is-valid");
                msgCpf.innerHTML = "";



            });

            //========Valida Nome==================

            window.campoNome = document.getElementById("nome");


            campoNome.addEventListener("input", () => {
                window.nome = campoNome.value

                if (nome.length < 1) {
                    campoNome.classList.remove("is-valid")
                    campoNome.classList.add("is-invalid")
                    msgNome.innerHTML = "Nome Inválido";
                }
                else {
                    campoNome.classList.remove("is-invalid")
                    campoNome.classList.add("is-valid")
                    msgNome.innerHTML = "";

                }
            })

            //========Valida Email===================
            window.email = document.getElementById("email")



            email.addEventListener("input", () => {

                const usuario = email.value.substring(0, email.value.indexOf("@"));
                const dominio = email.value.substring(email.value.indexOf("@") + 1, email.value.length);

                if ((usuario.length >= 1) &&
                    (dominio.length >= 3) &&
                    (usuario.search("@") == -1) &&
                    (dominio.search("@") == -1) &&
                    (usuario.search(" ") == -1) &&
                    (dominio.search(" ") == -1) &&
                    (dominio.search(".") != -1) &&
                    (dominio.indexOf(".") >= 1) &&
                    (dominio.lastIndexOf(".") < dominio.length - 1)) {
                    email.classList.remove("is-invalid")
                    email.classList.add("is-valid")
                    msgEmail.innerHTML = "";
                }
                else {
                    email.classList.remove("is-valid")
                    email.classList.add("is-invalid")
                    msgEmail.innerHTML = "E-mail Inválido";
                }
            })

            //==========Valida Senha==========================

            window.senha = document.getElementById("senha")
            window.senha2 = document.getElementById("senha2")

            senha.addEventListener("input", () => {


                if (senha.value == "") {
                    senha.classList.remove("is-valid")
                    senha.classList.add("is-invalid")
                    msgSenha.innerHTML = "Senha Inválida";
                    return false;
                }
                if (senha.value.length < 4) {
                    senha.classList.remove("is-valid")
                    senha.classList.add("is-invalid")
                    msgSenha.innerHTML = "Senha muito curta";
                    return false;
                }

                senha.classList.remove("is-invalid")
                senha.classList.add("is-valid")
                msgSenha.innerHTML = "";

            })


            senha2.addEventListener("input", () => {
                if (senha.value != senha2.value) {
                    senha2.classList.remove("is-valid")
                    senha2.classList.add("is-invalid")
                    msgSenha2.innerHTML = "Senhas Diferentes";
                    return false;
                }

                senha2.classList.remove("is-invalid")
                senha2.classList.add("is-valid")
                msgSenha2.innerHTML = "";


            })






            // Fetch all the forms we want to apply custom Bootstrap validation styles to
            var forms = document.getElementsByClassName('needs-validation');
            // Loop over them and prevent submission
            var validation = Array.prototype.filter.call(forms, function (form) {
                form.addEventListener('submit', function (event) {





                    //========Valida Nome==================


                    window.nome = campoNome.value

                    if (nome.length < 1) {
                        campoNome.classList.remove("is-valid")
                        campoNome.classList.add("is-invalid")
                        msgNome.innerHTML = "Nome inválido";
                        event.preventDefault();
                        event.stopPropagation();

                    }
                    else {
                        campoNome.classList.remove("is-invalid")
                        campoNome.classList.add("is-valid")

                    }

                    //========Valida Email===================


                    const usuario = email.value.substring(0, email.value.indexOf("@"));
                    const dominio = email.value.substring(email.value.indexOf("@") + 1, email.value.length);

                    if ((usuario.length >= 1) &&
                        (dominio.length >= 3) &&
                        (usuario.search("@") == -1) &&
                        (dominio.search("@") == -1) &&
                        (usuario.search(" ") == -1) &&
                        (dominio.search(" ") == -1) &&
                        (dominio.search(".") != -1) &&
                        (dominio.indexOf(".") >= 1) &&
                        (dominio.lastIndexOf(".") < dominio.length - 1)) {
                        email.classList.remove("is-invalid")
                        email.classList.add("is-valid")
                        msgEmail.innerHTML = "";
                    }
                    else {
                        email.classList.remove("is-valid")
                        email.classList.add("is-invalid")
                        msgEmail.innerHTML = "E-mail inválido";
                        event.preventDefault();
                        event.stopPropagation();

                    }


                    //==========Valida Senha==========================




                    if (senha.value == "") {
                        senha.classList.remove("is-valid")
                        senha.classList.add("is-invalid")
                        msgSenha.innerHTML = "Senha Inválida";
                        event.preventDefault();
                        event.stopPropagation();

                    } else {


                        senha.classList.remove("is-invalid")
                        senha.classList.add("is-valid")
                        msgSenha.innerHTML = "";

                    }
                    if (senha.value.length < 4) {
                        senha.classList.remove("is-valid")
                        senha.classList.add("is-invalid")
                        msgSenha.innerHTML = "Senha muito curta";
                        event.preventDefault();
                        event.stopPropagation();

                    } else {


                        senha.classList.remove("is-invalid")
                        senha.classList.add("is-valid")
                        msgSenha.innerHTML = "";

                    }





                    if (senha.value != senha2.value) {
                        senha2.classList.remove("is-valid")
                        senha2.classList.add("is-invalid")
                        msgSenha2.innerHTML = "Senhas Diferentes";
                        event.preventDefault();
                        event.stopPropagation();

                    }

                    if (senha2.value.length < 1 && senha.value.length < 1) {

                        senha2.classList.remove("is-valid")
                        senha2.classList.remove("is-invalid")
                        msgSenha2.innerHTML = "Senhas Vazias";
                        event.preventDefault();
                        event.stopPropagation();


                    }


                    if (senha.value == senha2.value && senha2.value.length != 0 && senha.value.length != 0) {
                        senha2.classList.remove("is-invalid")
                        senha2.classList.add("is-valid")
                        msgSenha2.innerHTML = "";
                    }



                    //===============Valida CNPJ===========

                    window.cpf = campoCpf.value



                    window.d1 = cpf.substring(0, 3)
                    window.d2 = cpf.substring(4, 7)
                    window.d3 = cpf.substring(8, 11)
                    window.d = cpf.substring(12, 14)

                    const cpfzao = d1 + d2 + d3 + d


                    // Elimina CPFs invalidos conhecidos
                    if (cpfzao.length != 11 ||
                        cpfzao == "00000000000" ||
                        cpfzao == "11111111111" ||
                        cpfzao == "22222222222" ||
                        cpfzao == "33333333333" ||
                        cpfzao == "44444444444" ||
                        cpfzao == "55555555555" ||
                        cpfzao == "66666666666" ||
                        cpfzao == "77777777777" ||
                        cpfzao == "88888888888" ||
                        cpfzao == "99999999999"
                    ) {
                        campoCpf.classList.remove("is-valid")
                        campoCpf.classList.add("is-invalid")
                        msgCpf.innerHTML = "CPF inválido";
                        event.preventDefault();
                        event.stopPropagation();
                        return false;

                    };

                    // Valida 1o digito
                    var add = 0;
                    var i, rev;

                    for (i = 0; i < 9; i++)
                        add += parseInt(cpfzao.charAt(i)) * (10 - i);
                    rev = 11 - (add % 11);
                    if (rev == 10 || rev == 11)
                        rev = 0;
                    if (rev != parseInt(cpfzao.charAt(9))) {
                        campoCpf.classList.remove("is-valid")
                        campoCpf.classList.add("is-invalid")
                        msgCpf.innerHTML = "CPF inválido";
                        event.preventDefault();
                        event.stopPropagation();
                        return false;
                    };

                    // Valida 2o digito
                    add = 0;

                    for (i = 0; i < 10; i++)
                        add += parseInt(cpfzao.charAt(i)) * (11 - i);
                    rev = 11 - (add % 11);
                    if (rev == 10 || rev == 11)
                        rev = 0;
                    if (rev != parseInt(cpfzao.charAt(10))) {
                        campoCpf.classList.remove("is-valid")
                        campoCpf.classList.add("is-invalid")
                        msgCpf.innerHTML = "CPF inválido";
                        event.preventDefault();
                        event.stopPropagation();
                        return false;
                    };




                }, false);
            });
        }, false);
    })();




</script>